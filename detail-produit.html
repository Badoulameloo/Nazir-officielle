<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DÉTAILS PRODUIT | NAZIR</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="img/favicon-32x32.png">
</head>
<body>

    <nav class="navbar">
        <div class="nav-left">
            <a href="index.html">HOME</a>
            <a href="heritage.html">HÉRITAGE</a>
            <a href="contact.html">CONTACT</a>
        </div>
        <div class="nav-logo">
            <img src="img\img.logo.jpeg.png.png" alt="NAZIR">
        </div>
        <div class="nav-right">
            <a href="panier.html">PANIER</a>
        </div>
    </nav>

    <main class="details-container">
        <div class="details-grid">

            
            <div class="details-image1">
                <div class="image-wrapper">
                    <p class="image-label">FRONT VIEW</p>
                    <img src="img/img.frontshirt.jpeg.jpeg" alt="Devant" id="dyn-img-front" class="detail-main-img">
                </div>

                <div class="image-wrapper">
                    <p class="image-label">BACK VIEW</p>
                    <img src="img/img.backshirt.jpeg.jpeg.jpeg" alt="Dos" id="dyn-img-back" class="detail-main-img">
                </div>
            </div>

            <div class="details-image2">
                <div class="image-wrapper">
                    <p class="image-label">FRONT VIEW</p>
                    <img src="img/img.white&greyfrontshirt.jpeg.jpeg.jpeg" alt="Devant" id="dyn-img-front" class="detail-main-img">
                </div>

                <div class="image-wrapper">
                    <p class="image-label">BACK VIEW</p>
                    <img src="img/img.white&greybackshirt.jpeg.jpeg.jpeg" alt="Dos" id="dyn-img-back" class="detail-main-img">
                </div>
            </div>

               <div class="details-image3">
                <div class="image-wrapper">
                    <p class="image-label">FRONT VIEW</p>
                    <img src="img/img.black&greyfrontshirtshirt.jpeg.jpeg.jpeg" alt="Devant" id="dyn-img-front" class="detail-main-img">
                </div>

                <div class="image-wrapper">
                    <p class="image-label">BACK VIEW</p>
                    <img src="img/img.black&greybackshirt.jpeg.jpeg.jpeg" alt="Dos" id="dyn-img-back" class="detail-main-img">
                </div>
            </div>
            

            <div class="details-info">
                <p class="brand-subtitle">NAZIR / HÉRITAGE EDITION</p>
                
                <h1 id="dyn-nom">...</h1>
                
                <p class="price" id="dyn-prix">...</p>
                
                <div class="description">
                    <p id="dyn-desc">...</p>
                </div>

                <div class="size-selection">
                    <p class="size-label">SÉLECTIONNER LA TAILLE</p>
                    <div class="size-options">
                        <input type="radio" name="size" value="S" id="s"><label for="s">S</label>
                        <input type="radio" name="size" value="M" id="m"><label for="m">M</label>
                        <input type="radio" name="size" value="L" id="l" checked><label for="l">L</label>
                        <input type="radio" name="size" value="XL" id="xl"><label for="xl">XL</label>
                    </div>
                </div>

                <button onclick="allerAuPaiement()" class="add-to-cart-btn">PROCÉDER AU PAIEMENT</button>
            </div>
        </div>
    </main>

   <script>
window.onload = function() {
    // 1. Récupération des données classiques
    const nom = localStorage.getItem('produitNom');
    const prix = localStorage.getItem('produitPrix');
    const desc = localStorage.getItem('produitDesc');
    const imgFront = localStorage.getItem('produitImage'); 
    const imgBack = localStorage.getItem('produitImageDos');
    
    // --- NOUVEAU : Récupération des tailles disponibles ---
    const taillesDispoString = localStorage.getItem('produitTaillesDispo');

    // 2. Remplissage des textes
    if(nom) document.getElementById('dyn-nom').innerText = nom;
    if(prix) document.getElementById('dyn-prix').innerText = prix;
    if(desc) document.getElementById('dyn-desc').innerText = desc;

    // 3. Remplissage des images
    if(imgFront) document.getElementById('dyn-img-front').src = imgFront;

    const backImgElement = document.getElementById('dyn-img-back');
    if(imgBack && imgBack !== "" && imgBack !== "undefined") {
        backImgElement.src = imgBack;
    } else {
        if(backImgElement) backImgElement.parentElement.style.display = 'none';
    }

    // --- 4. LOGIQUE DES TAILLES (Le moteur qui barre le "S") ---
    if (taillesDispoString) {
        const disponibles = taillesDispoString.split(','); // Ex: ["M", "L", "XL"]
        const toutesLesTailles = ['S', 'M', 'L', 'XL'];

        toutesLesTailles.forEach(taille => {
            const input = document.getElementById(taille.toLowerCase()); // s, m, l, xl
            const label = document.querySelector(`label[for="${taille.toLowerCase()}"]`);

            if (input && label) {
                if (!disponibles.includes(taille)) {
                    // Si la taille n'est pas dans la liste des dispos
                    input.disabled = true; // Empêche de cliquer sur le bouton radio
                    label.classList.add('out-of-stock'); // Applique le style barré du CSS
                    
                    // Si par hasard cette taille était cochée, on la décoche
                    if(input.checked) input.checked = false;
                }
            }
        });

        // Sécurité : Si la taille "L" est barrée mais cochée par défaut, 
        // on coche la première taille disponible à la place.
        const radioCoche = document.querySelector('input[name="size"]:checked');
        if (radioCoche && radioCoche.disabled) {
            const premierDispo = toutesLesTailles.find(t => disponibles.includes(t));
            if(premierDispo) document.getElementById(premierDispo.toLowerCase()).checked = true;
        }
    }
};

function allerAuPaiement() {
    const tailleCheck = document.querySelector('input[name="size"]:checked');
    if(tailleCheck && !tailleCheck.disabled) {
        localStorage.setItem('produitTaille', tailleCheck.value);
        window.location.href = 'paiement.html';
    } else {
        alert("Veuillez sélectionner une taille disponible.");
    }
}